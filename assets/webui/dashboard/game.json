{"title":"Feint Games","appear":"$('#header .title').html(OF.page.title);","scrolling":true,"init":"$('body').addClass('textured');\n$('.button').pretouch();\n\n// Menu handling functions\nif (!OF.menu) {\n  OF.menu = function(buttonName) {\n    if      (buttonName == 'home')      OF.menu.home();\n    else if (buttonName == 'settings')  OF.menu.settings();\n    else if (buttonName == 'exit')      OF.menu.exit();\n    else {\n      OF.log('Unknown menu button hit: '+ buttonName);\n    }\n  };\n  \n  OF.menu.home = function() {\n    if (OF.navigationStack[0].url.match(/dashboard\\/user/)) {\n      OF.goBack({root:true});\n    } else {\n      OF.navigateToUrl(\"dashboard/user\", {\n        complete: function() {\n          OF.navigationStack = [OF.page];\n          OF.sendAction('back', {root:true});\n        }\n      });\n    }\n  };\n  \n  OF.menu.settings = function() {\n    OF.sendAction('openSettings');\n  };\n  \n  OF.menu.exit = function() {\n    OF.sendAction('dismiss');\n  };\n}\n\n// Base friends page functions\nif (!OF.friendsList) {\n  OF.friendsList = {\n    init: function() {\n      $.lazyLoad({\n        threshold: 0.5,  //percentage of the window height left to scroll that will trigger the next page\n        nextPageLoaded: function(page, data){ \n          if(page == 1) {\n            OF.friendsList.renderFriends(data);                 \n          } else {\n            OF.friendsList.addFriends(data);         \n          }\n        },\n        nextPageShouldLoad: function(page, callback) {\n          OF.api.request('/xp/friends', {\n            params: { user_id: OF.page.user.id, page:page, page_size:50 },\n            success: function(data){ callback(data.users, data.users.length < 50) },\n            failure: function(){ callback([]); }\n          });\n        },\n        isEmpty: function() { OF.friendsList.renderFriends([]); },\n        isFinished: function() { $(\"#loading\").hide(); }\n      });\n    },\n    \n    renderFriendItems: function(friends) {\n      var html = $.map(friends, function(friend) {\n       return tmpl('user_tmpl', friend);\n      });\n      return html;\n    },\n    \n    renderFriends : function(friends) {    \n      var html = OF.friendsList.renderFriendItems(friends);\n      \n      if (html.length > 0) {\n        $('#friends_list > ul').html(html.join('')).unhide();\n        $(\"#friends_list .no_data\").hide();\n      } else {\n        $('#friends_list > ul').hide();\n        $(\"#friends_list .no_data\").unhide();      \n      }\n    },\n    \n    addFriends : function(friends) {    \n      var html = OF.friendsList.renderFriendItems(friends);\n      $('#friends_list > ul').append(html.join(''));\n    }\n  };\n}\n\n// Go home on touching the logo area\n$('#home_button').touch(OF.menu.home);\nvar game = OF.page.params.game;\nOF.page.game = game;\n\nvar last_screenshot = null;\n\n$('li#game_info .icon').css('background-image', 'url('+ game.android_icon_url +')');\n$('li#game_info .title').text(game.name);\n$('li#game_info .subtitle').text(game.developer_name);\n\n$('.thumbnail').touch(function() {\n  var mainImg = $('#main')\n  var tappedImg = $(this).children('img');\n  mainImg.css('background-image', 'url('+ tappedImg[0].src +')');\n  mainImg[0].className = tappedImg.data('isLandscape') ? 'landscape' : '';\n});\n\nOF.api.request('/xp/games/'+ game.id +'/descriptions/android', {\n  method: 'GET',\n  success: function(data) {\n    OF.page.game.description = data.description;\n    \n    $('#buy .price').text('$'+ OF.page.game.description.price);\n    $('.game_description').html(OF.page.game.description.description.replace(/\\n/g, '<br>'));\n    \n    if (OF.page.game.description.screenshots.length) {\n      $('.thumbnail').hide();\n      $.each(OF.page.game.description.screenshots.slice(0,4), function(i) {\n        $('.thumbnail:eq('+ i +')').show();\n        $('.thumbnail:eq('+ i +') img')\n          .data('isLandscape', this.is_landscape)\n          [0].src = this.url;\n          last_screenshot = i;\n      });\n      \n      $('#main').css('background-image', 'url('+ OF.page.game.description.screenshots[0].url +')');\n      resetPlayButton();\n    }\n    \n    OF.page.onIsInstalled = function(installed) {\n      if (installed) {\n        $('#buy').addClass('disabled').text('Installed').unhide();\n      } else {\n        $('#buy').unhide().touch(function() {\n          OF.sendAction('openMarket', { package_name: OF.page.game.description.package_identifier });\n        });\n      }\n    }\n    \n    if (OF.isDevice) {\n      OF.sendAction('isApplicationInstalled', {\n        package_name: OF.page.game.description.package_identifier,\n        callback: 'OF.page.onIsInstalled'\n      });\n    } else {\n      OF.page.onIsInstalled(false);\n    }\n  },\n  failure: function(data, status) {\n    if (status.match(/404/)) {\n      OF.goBack();\n      OF.alert('No Game Info', 'The developer of this game has not yet setup all the information for this screen.');\n    }\n  }\n});\n\nvar resetPlayButton = function() {\n  if (last_screenshot && OF.page.game.description.youtube.video_id && OF.page.game.description.youtube.video_id.length) {\n    $('span.movie_play_overlay').remove();\n    \n    var el = $('.thumbnail:eq('+ last_screenshot +')');\n    el.append(\"<span class='movie_play_overlay'></span>\");\n    \n    $('.thumbnail:eq('+ last_screenshot +')').touch(function(){\n      OF.sendAction('openYoutubePlayer', { video_id: OF.page.game.description.youtube.video_id });\n    })\n  }\n}\n\nOF.page.orientationChanged = function() {\n  resetPlayButton();\n}","html":"<div id='dashboard'>\n<div id='header'>\n<span class='loading'>\n<span class='spinner'></span>\n</span>\n<div class='title' id='home_button'></div>\n</div>\n<div id='games'>\n<ul class='cells'>\n<li class='liquid clearfix' id='game_info'>\n<div class='button hidden' id='buy'>\nBuy!\n<div class='price'></div>\n</div>\n<div class='icon'></div>\n<div class='title'></div>\n<div class='subtitle'></div>\n</li>\n<li class='section_title'>Screenshots</li>\n<li class='liquid clearfix' id='screenshots'>\n<div id='main'></div>\n<div id='thumbnails'>\n<div class='thumbnail'>\n<img>\n</div>\n<div class='thumbnail'>\n<img>\n</div>\n<div class='thumbnail'>\n<img>\n</div>\n<div class='thumbnail'>\n<img>\n</div>\n</div>\n</li>\n<li class='section_title'>Game Information</li>\n<li class='game_description liquid'></li>\n</ul>\n</div>\n\n</div>\n"}
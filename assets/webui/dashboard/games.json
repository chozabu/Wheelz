{"title":"Feint Games","appear":"$('#header .title').html(OF.page.title);","scrolling":true,"init":"$('body').addClass('textured');\n$('.button').pretouch();\n\n// Menu handling functions\nif (!OF.menu) {\n  OF.menu = function(buttonName) {\n    if      (buttonName == 'home')      OF.menu.home();\n    else if (buttonName == 'settings')  OF.menu.settings();\n    else if (buttonName == 'exit')      OF.menu.exit();\n    else {\n      OF.log('Unknown menu button hit: '+ buttonName);\n    }\n  };\n  \n  OF.menu.home = function() {\n    if (OF.navigationStack[0].url.match(/dashboard\\/user/)) {\n      OF.goBack({root:true});\n    } else {\n      OF.navigateToUrl(\"dashboard/user\", {\n        complete: function() {\n          OF.navigationStack = [OF.page];\n          OF.sendAction('back', {root:true});\n        }\n      });\n    }\n  };\n  \n  OF.menu.settings = function() {\n    OF.sendAction('openSettings');\n  };\n  \n  OF.menu.exit = function() {\n    OF.sendAction('dismiss');\n  };\n}\n\n// Base friends page functions\nif (!OF.friendsList) {\n  OF.friendsList = {\n    init: function() {\n      $.lazyLoad({\n        threshold: 0.5,  //percentage of the window height left to scroll that will trigger the next page\n        nextPageLoaded: function(page, data){ \n          if(page == 1) {\n            OF.friendsList.renderFriends(data);                 \n          } else {\n            OF.friendsList.addFriends(data);         \n          }\n        },\n        nextPageShouldLoad: function(page, callback) {\n          OF.api.request('/xp/friends', {\n            params: { user_id: OF.page.user.id, page:page, page_size:50 },\n            success: function(data){ callback(data.users, data.users.length < 50) },\n            failure: function(){ callback([]); }\n          });\n        },\n        isEmpty: function() { OF.friendsList.renderFriends([]); },\n        isFinished: function() { $(\"#loading\").hide(); }\n      });\n    },\n    \n    renderFriendItems: function(friends) {\n      var html = $.map(friends, function(friend) {\n       return tmpl('user_tmpl', friend);\n      });\n      return html;\n    },\n    \n    renderFriends : function(friends) {    \n      var html = OF.friendsList.renderFriendItems(friends);\n      \n      if (html.length > 0) {\n        $('#friends_list > ul').html(html.join('')).unhide();\n        $(\"#friends_list .no_data\").hide();\n      } else {\n        $('#friends_list > ul').hide();\n        $(\"#friends_list .no_data\").unhide();      \n      }\n    },\n    \n    addFriends : function(friends) {    \n      var html = OF.friendsList.renderFriendItems(friends);\n      $('#friends_list > ul').append(html.join(''));\n    }\n  };\n}\n\n// Go home on touching the logo area\n$('#home_button').touch(OF.menu.home);\nvar userID = OF.page.params.user_id || OF.user.id;\nvar gameTmpl = tmpl('game_tmpl');\n\nvar sendGamesRequest = function(from) {\n  (OF.page.params.user_id == OF.user.id)\n    ? sectionTitle = \"Your Games\" \n    : sectionTitle = OF.page.params.user_name+ \"'s Games\";\n  OF.api.request('/xp/users/'+ userID +'/games', {\n    loader: 'li.loading',\n    success: function(data) {\n      $('.section_title').text(sectionTitle);\n      OF.page.games = data.games;\n      \n      var html = '';\n      if (OF.page.games.length > 0){          \n        $.each(OF.page.games, function(i) {\n          this.game.index = i;\n          html += gameTmpl(this.game);\n        });\n        $('#game_list').show().append(html).unhide();\n        \n        $('.game_cell').touch(function() {\n          var game = OF.page.games[parseInt($(this).attr('data-game_index'))].game;\n          OF.navigateToUrl('dashboard/game', { params: { game: game } });\n        })\n        \n      } else {\n        $('ul#game_list').append($('#no_games').html()).unhide();\n      }\n    }\n  });\n}\n\nif (typeof OF.page.params.user_name === 'undefined') {\n  OF.api.request('/xp/users/'+ userID, {\n    success: function(data) {\n      OF.page.params.user_name = data.user.name;\n      sendGamesRequest();\n    }\n  });\n} else {\n  sendGamesRequest();\n}","html":"<div id='dashboard'>\n<div id='header'>\n<span class='loading'>\n<span class='spinner'></span>\n</span>\n<div class='title' id='home_button'></div>\n</div>\n          <script type=\"text/plain\" id=\"game_tmpl\">\n            <% var icon_url = OF.deviceType.Android ? android_icon_url : ios_icon_url; %>\n<% var style = null; %>\n<% if(icon_url){  style = \"background-image: url(\" + icon_url + \")\"; } %>\n\n<li class=\"game_cell one_line\" data-game_index=\"<%= index %>\">\n  <div class=\"icon\" style=\"<%= style  %>\"></div>\n  <div class=\"title\"><%= name %></div>\n</li>\n          </script>\n          <script type=\"text/plain\" id=\"no_games\">\n            <li class=\"no_data\">This user doesn't have any Android compatible Feint Games.</li>\n          </script>\n<div id='games'>\n<ul class='cells'>\n<li class='section_title'></li>\n</ul>\n<ul class='cells' id='game_list'>\n<li class='loading'>\n<div class='spinner'></div>\n</li>\n</ul>\n</div>\n\n</div>\n"}
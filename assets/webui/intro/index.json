{"title":"Initializing Open Feint...","scrolling":true,"init":"$('body').addClass('textured');\n$('#header .loading').hide();\n$('.button').pretouch();\n\nif (OF.page.params.mode == 'switch') {\n  OF.introSwitch = true;\n}\n\nif (OF.introSwitch) {\n  $('.switch_flow').unhide(0);\n  $('.intro_flow').hide();\n}\n$('.game_name').text(OF.game.name);\n\n\nif (OF.page.params.for_new_account) {\n  \n  $('#new_account').unhide(0);\n  $('#intro_index .loading').hide();\n  $('.with_decline').hide();\n  \n} else {\n  \n  if (OF.page.params.preapproved) {\n    $('.with_decline').hide();\n  } else {\n    $('.without_decline').hide();\n  }\n  \n  // Find any users for this device\n  var req = OF.api.request(\"/xp/devices/\" + OF.device.identifier + \"/users\", {\n    httpParams: { timeout: 8000 },\n    success: function(data) {\n      OF.users = data.users;\n      if (OF.users.length == 0) {\n        \n        // No user found, new user\n        $('#intro_index .loading').fadeOut('fast', function() {\n          $('#new_account').unhide();            \n        });\n        \n      } else {\n        \n        // Found a user show, let them login\n        OF.user = data.users[0].user;\n        $('#found_device .user_name').text(OF.user.name);\n        $('#found_device .feint_score').text(OF.user.gamer_score);\n        \n        if (OF.user.profile_picture_url) {\n          $('#found_device .avatar').css('background-image', 'url('+ OF.user.profile_picture_url +')');\n        }\n        \n        $('#intro_index .loading').fadeOut('fast');\n        $('.features').fadeOut(function() {\n          $('#found_device').unhide();\n        });\n      }\n    },\n    failure: function(data, status) {\n      if (status.match(/^0/)) {\n        $('#intro_index .loading').fadeOut('fast', function() {\n          $('#new_account').unhide();            \n        });\n      } else {\n        alert('Sorry! Feint is offline right now. Please try again in a few minutes.');\n        OF.sendAction('dismiss');          \n      }\n    }\n  });    \n}\n\n// Activiate form submission hanlders\n$('form').submit(function() {\n  $(this).children('#submit').touch();\n  return false;\n})\n\n\n\n\n\n// New Account\n$('#new_account #submit').touch(function() {\n  if (!$('#new_account form').isLoading()) {\n    var name = $('#new_account #user_login').val();\n    \n    if (name.length > 0) {\n      $('#new_account form').isLoading(true);\n      OF.api.request('/xp/users/validate', {\n        loader: '#new_account #submit',\n        params: { name: escape(name) },\n        on404: function(data) {\n          OF.navigateToUrl('intro/new_account', {\n            params: {\n              userName: $('#new_account #user_login').val()\n            }\n          });\n        },\n        on406: function(data) {\n          OF.alert(\"Invalid Username\", $.htmlDecode(data.exception.message));\n        },\n        on409: function(data) {\n          var suggestion = $.htmlDecode(data.username.suggestion);\n          if (confirm('Oops, looks like that user name is already taken. Would you like to continue with \"' + suggestion + '\"?  Remember you can always change it later.')) {\n            $('#new_account #user_login').val(suggestion);\n            $('#new_account form').isLoading(false);\n            $('#new_account #submit').touch();\n          }\n        },\n        failure: function(data, status) {\n          if(!status.match(/^40(4|6|9)/)){ return false; }\n        },\n        complete: function() {\n          $('#new_account form').isLoading(false);\n        }\n      });\n    } else {\n      OF.alert('Enter a name', 'Enter your desired username in the textfield to continue.');\n    }\n  }\n});\n\n\n\n\n\n// Found Device\n$('#found_device .game_name').html(OF.game.name);\n$('#found_device .user_name').html(OF.user.name);\n$('#found_device .feint_score').html(OF.user.gamer_score);\nif (OF.user.profile_picture_url) {\n  $('#found_device .avatar').css('background-image', 'url('+ OF.user.profile_picture_url +')');\n}\n\nOF.page.boostrapCallback = function(status, response) {\n  $('#found_device form').isLoading(false);\n  $('#found_device #submit').text('Start Playing!');\n  OF.loader.hide();\n  if (status.match(/^2/)) {\n    OF.log('Successfully bootstrapped with user name: \"'+ OF.user.name +'\" id: '+ OF.user.id);\n    OF.sendAction('dismiss');\n  } else if (status.match(/404/)) {\n    OF.alert('Account not found', 'There is no Feint account with that username/email.');\n  } else if (status.match(/401/)) {\n    OF.alert('Incorrect Password', 'The password entered is incorrect.');\n  } else {\n    var message = (response.exception && response.exception.message) ? $.htmlDecode(response.exception.message) : 'Check your username and password and try again';\n    OF.alert('Authentication failed', message);\n  }\n};\n\n$('#found_device #submit').touch(function() {\n  if (!$('#found_device form').isLoading()) {\n    if ($.trim($('#found_device #user_password').val()).length) {\n      $('#found_device form').isLoading(true);    \n      OF.loader.show();\n      $('#found_device #submit').html('Loading').append('&hellip;');\n      OF.sendAction('loginUser', {\n        user_id:  OF.user.id,\n        password: $('#found_device #user_password').val(),\n        callback: 'OF.page.boostrapCallback'\n      });\n    } else {\n      OF.alert('Missing Password', 'Enter your password to login as this user.');\n    }\n  }\n});","html":"<div id='intro'>\n<div id='header'>\n<span class='loading'>\n<span class='spinner'></span>\n</span>\n</div>\n<div class='content'>\n<div id='intro_index'>\n<div class='switch_flow hidden'>\n<p>Create a new Feint account.</p>\n</div>\n<div class='intro_flow'>\n<p>\nPlay\n<span class='game_name'></span>\nwith your friends and other gamers!\n</p>\n<div class='features'>\n<div class='feature_row'>\n<div class='feature' id='leaderboards'>\n<div class='icon'></div>\n<div class='title'>\nPost<br>\nHigh Scores\n</div>\n</div>\n<div class='feature' id='friends'>\n<div class='icon'></div>\n<div class='title'>\nPlay<br>\nwith Friends\n</div>\n</div>\n<div class='feature' id='achievements'>\n<div class='icon'></div>\n<div class='title'>\nEarn<br>\nAchievements\n</div>\n</div>\n<div class='feature' id='games'>\n<div class='icon'></div>\n<div class='title'>\nDiscover<br>\nGames\n</div>\n</div>\n</div>\n</div>\n<div class='loading'>\n<div class='spinner'></div>\n<span>Loading</span>\n</div>\n</div>\n<div class='hidden' id='new_account'>\n<form>\n<div class='input_field'>\n<label>Feint Name:</label>\n<input id='user_login' name='user[login]' type='text'>\n</div>\n<div class='button default' id='submit'>Create</div>\n</form>\n<div class='with_decline'>\n<div class='button_row'>\n<div class='button_wrapper'>\n<div class='button' data-action='decline'>\nI don't want<br>\nto use Feint\n</div>\n</div>\n<div class='button_wrapper'>\n<div class='button' data-href='intro/login'>\nI already have<br>\na Feint account\n</div>\n</div>\n</div>\n</div>\n<div class='without_decline'>\n<div class='button' data-href='intro/login'>\nI already have a Feint account\n</div>\n</div>\n<div class='intro_flow'>\n<div data-href='intro/tos' id='intro_legal'>\nGame Data will automatically be stored securely on our servers according to our\n<span data-href='intro/tos'>Terms and Conditions.</span>\n</div>\n</div>\n</div>\n<div class='hidden' id='found_device'>\n<div class='inset_cell user'>\n<div class='image avatar'>\n<div class='overlay'></div>\n</div>\n<div class='title user_name'></div>\n<div class='feint_score'></div>\n</div>\n<form>\n<div class='input_field'>\n<label>Password:</label>\n<input id='user_password' name='user[password]' type='password'>\n</div>\n<div class='button default' id='submit'>Start Playing!</div>\n</form>\n<div class='with_decline'>\n<div class='button_row'>\n<div class='button_wrapper'>\n<div class='button' data-action='decline'>\nI don't want<br>\nto use Feint\n</div>\n</div>\n<div class='button_wrapper'>\n<div class='button' data-href='intro/login'>\nUse Another<br>\nAccount\n</div>\n</div>\n</div>\n</div>\n<div class='without_decline'>\n<div class='button' data-href='intro/login'>\nUse Another Account\n</div>\n</div>\n</div>\n</div>\n\n</div>\n</div>\n"}